# מדריך בטיחות MongoDB - למניעת אובדן נתונים

## 🛡️ הבדלים מ-Vercel Blob

### Vercel Blob (הבעיה הישנה):
- ❌ מוחק הכל כשחורגים מהמגבלה
- ❌ אין אזהרות מוקדמות
- ❌ אין גיבויים אוטומטיים

### MongoDB Atlas (הפתרון החדש):
- ✅ **לא מוחק נתונים!** רק עובר ל-Read-Only
- ✅ שולח אזהרות במייל
- ✅ יש גיבויים אוטומטיים
- ✅ אפשר לשחזר נתונים

## 📊 בדיקת גודל

הרץ את הסקריפט:
\`\`\`bash
node scripts/check-mongodb-size.js
\`\`\`

זה יראה לך:
- כמה מקום תפוס
- כמה נשאר
- אחוז שימוש
- פירוט לפי קולקשן

## 🔔 הגדרת התראות ב-MongoDB Atlas

### שלב 1: כנס ל-MongoDB Atlas
1. לך ל-https://cloud.mongodb.com
2. התחבר לחשבון שלך
3. בחר את הפרויקט "otzaria"

### שלב 2: הגדר Alerts
1. לחץ על "Alerts" בתפריט השמאלי
2. לחץ על "Create Alert"
3. בחר "Database" → "Data Size"
4. הגדר:
   - **Condition**: Data Size is above
   - **Threshold**: 400 MB (80% מ-512MB)
   - **Notification**: Email
   - **Email**: המייל שלך

### שלב 3: הוסף עוד התראות
חזור על התהליך עבור:
- **75%**: 384 MB
- **90%**: 460 MB

## 💾 אסטרטגיית גיבויים

### 1. גיבוי ידני (מומלץ!)
- לחץ על "גיבוי מלא" בפאנל הניהול
- שמור ב-Google Drive / Dropbox
- תעשה זאת **פעם בשבוע**

### 2. גיבוי אוטומטי ב-MongoDB
- MongoDB שומר גיבויים אוטומטיים
- נשמר ב-collection בשם "backups"
- מוחק גיבויים ישנים מ-7 ימים

### 3. גיבוי חיצוני (אופציונלי)
- הורד גיבוי פעם בחודש
- שמור במחשב שלך
- שמור גם ב-cloud (Google Drive)

## 📈 מה קורה כשחורגים מהמגבלה?

### MongoDB Free Tier (512MB):
1. **80% (410MB)**: מקבל מייל אזהרה
2. **90% (460MB)**: מקבל מייל דחוף
3. **100% (512MB)**: 
   - ✅ הנתונים **נשארים**!
   - ⚠️ המערכת עוברת ל-Read-Only
   - 📖 אפשר לקרוא, אי אפשר לכתוב
   - 💰 צריך לשדרג או למחוק נתונים

### פתרונות:
1. **שדרוג ל-M2** ($9/month):
   - 2GB storage
   - Dedicated cluster
   - הרבה יותר מהיר

2. **מחיקת נתונים ישנים**:
   - מחק גיבויים ישנים
   - מחק העלאות ישנות
   - ארכב נתונים

## 🔍 מוניטורינג שוטף

### בדוק כל שבוע:
\`\`\`bash
node scripts/check-mongodb-size.js
\`\`\`

### בדוק ב-MongoDB Atlas:
1. לך ל-Dashboard
2. בדוק "Metrics"
3. עקוב אחרי "Data Size"

## 📊 חישוב גס לעתיד

### הנתונים שלך:
- משתמש: ~5KB
- עמוד: ~2KB
- ספר: ~1KB
- העלאה: ~50KB (מטא-דאטה)

### דוגמאות:
- 100 משתמשים = 0.5MB
- 1000 עמודים = 2MB
- 50 ספרים = 0.05MB
- 100 העלאות = 5MB

**סה"כ לדוגמה**: ~8MB

### מתי תגיע ל-512MB?
עם הקצב הנוכחי:
- 10,000 משתמשים
- 250,000 עמודים
- 5,000 ספרים

**מסקנה**: יש לך הרבה מקום! 🎉

## ✅ רשימת בדיקות

- [ ] הגדרתי התראות ב-MongoDB Atlas
- [ ] הורדתי גיבוי ראשון
- [ ] שמרתי את הגיבוי ב-Google Drive
- [ ] הרצתי את check-mongodb-size.js
- [ ] הוספתי תזכורת בלוח שנה לגיבוי שבועי

## 🆘 במקרה חירום

אם בכל זאת קרה משהו:
1. **אל תיבהל!** הנתונים ב-MongoDB לא נמחקים
2. הורד גיבוי מ-MongoDB Atlas
3. או שחזר מהגיבוי האחרון שהורדת
4. צור קשר עם MongoDB Support (יש להם גיבויים)

## 📞 תמיכה

- MongoDB Support: https://support.mongodb.com
- Vercel Support: https://vercel.com/support
- תיעוד MongoDB: https://docs.mongodb.com
